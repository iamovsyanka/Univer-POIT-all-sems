--1.	?????????? ??????? ????????? ? ??????? ?????? ???????????? ??????????? ?????.
select * from v$pdbs;
select * from session_privs;

--2.	???????? ?????????????????? S1
create sequence S1
      increment by 10
      start with 1000
      nomaxvalue nominvalue nocycle nocache noorder;

select S1.nextval from dual;
select S1.currval from dual;

drop sequence S1;

--3. ???????? ?????????????????? S2
create sequence S2
      increment by 10
      start with 10
      maxvalue 100
      nominvalue nocycle nocache noorder;
      
select S2.nextval from dual;
select S2.currval from dual;

drop sequence S2;

--4. ???????? ?????????????????? S3
create sequence S3
      start with -10
      increment by -10
      minvalue -100
      nocycle order;
      
select S3.nextval from dual;
select S3.currval from dual;

drop sequence S3;

--5. ???????? ?????????????????? S4
create sequence S4
      start with 1
      increment by 1
      maxvalue 10
      cycle
      cache 5
      noorder;
      
select S4.nextval from dual;
select S4.currval from dual;   

drop sequence S4;

--6.	???????? ?????? ???? ??????????????????? ? ??????? ???? ??????, ?????????? ??????? ???????? ???????????? XXX.
select * from sys.dba_sequences where sequence_owner='SYSTEM';

--7.	???????? ??????? T1, ??????? ??????? N1, N2, N3, N4, ???? NUMBER (20)
create table T1 (N1 number(20),
                 N2 number(20),
                 N3 number(20),
                 N4 number(20)) cache;
alter table T1 storage (buffer_pool keep);

declare i number:=1;
begin loop
insert into T1 (N1, N2, N3, N4) values (S1.nextval, S2.nextval, S3.nextval, S4.nextval);
i:=i+1;
exit when i=8;
end loop;
end;

select * from T1;

drop table T1;

--8.	???????? ??????? ABC, ??????? hash-??? (?????? 200) ? ?????????? 2 ????: X (NUMBER (10)), V (VARCHAR2(12)).
create cluster ABC(X number(10),
                   V varchar2(12)
                  ) hashkeys 200;
                  
--9.	???????? ??????? A, ??????? ??????? XA (NUMBER (10)) ? VA (VARCHAR2(12)), ????????????? ???????? ABC, ? ????? ??? ???? ???????????? ???????.
create table A(XA number(10),
               VA varchar2(12), 
               NA number(20))
cluster ABC (XA, VA); 

--10.	???????? ??????? B, ??????? ??????? XB (NUMBER (10)) ? VB (VARCHAR2(12)), ????????????? ???????? ABC, ? ????? ??? ???? ???????????? ???????.
create table B(XB number(10),
               VB varchar2(12), 
               NB number(20))
cluster ABC (XB, VB); 

--11.	???????? ??????? ?, ??????? ??????? X? (NUMBER (10)) ? V? (VARCHAR2(12)), ????????????? ???????? ABC, ? ????? ??? ???? ???????????? ???????. 
create table C(XC number(10),
               VC varchar2(12), 
               NC number(20))
cluster ABC (XC, VC); 

--12.	??????? ????????? ??????? ? ??????? ? ?????????????? ??????? Oracle.
select * from dba_clusters;
select * from dba_tables where owner = 'SYSTEM';

--13.	???????? ??????? ??????? ??? ??????? XXX.? ? ????????????????? ??? ??????????.
create synonym synonymC for SYSTEM.C;
select * from synonymC;

drop synonym synonymC;

--14.	???????? ????????? ??????? ??? ??????? XXX.B ? ????????????????? ??? ??????????.
create public synonym synonymB for SYSTEM.B;
select * from synonymB;

drop public synonym synonymB;

--15.	???????? ??? ???????????? ??????? A ? B (? ????????? ? ??????? ???????), ????????? ?? ???????, ???????? ????????????? V1, ?????????? ?? SELECT... FOR A inner join B. ????????????????? ??? ?????????????????.
drop table A;
drop table B;

alter table A drop constraint x_pk;

create table A(x number(10), y varchar(12),constraint x_pk primary key (x));

insert into A (x, y) values (1,'a');
insert into A (x, y) values (2,'b');
insert into A (x, y) values (3,'c');
commit;

select * from A;

create table B(x number(10),y varchar(12), constraint x_fk foreign key (x) references A(x));

insert into B (x, y) values (1,'x');
insert into B (x, y) values (2,'y');
insert into B (x, y) values (3,'z');
commit;

select * from B;

create view V1 as select A.y as A_Y, B.y as B_Y from A inner join B on A.x=B.x;
select * from V1;

drop view V1;

--16.	?? ?????? ?????? A ? B ???????? ????????????????? ????????????? MV, ??????? ????? ????????????? ?????????? 2 ??????. ????????????????? ??? ?????????????????.
create materialized view MV
build immediate 
refresh complete on demand next sysdate + numtodsinterval(2, 'minute') 
as select * from A;

select * from MV;    

insert into A (x, y) values (4,'d');
insert into A (x, y) values (5,'e');
commit;

drop materialized view MV;